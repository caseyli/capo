<script type="text/javascript">
	/* EVENT HANDLERS *****************************************************************************/
	$(function() {
		
		/* STARTUP */
		checkLoggedIn();

		/* EVENT HANDLER INITIALIZATION */
		/* Sessions */
		$("#loginButton").tap(function(e, info) {
			login();
		});
		
		$("#registerButton").tap(function(e, info){
			register();
		});
		
		$("#logoffButton").tap(function(e, info) {
			if (confirm("Are you sure you want to logoff?")) {
				logoff();	
			}
		});
		
		$("#toolbarlogoffButton").tap(function(e, info) {
			if (confirm("Are you sure you want to logoff?")) {
				logoff();
			}
		});
		
		
		/* Open Mics */
		$("#filter").bind('pageAnimationStart', function(event, info){
			loadFilterCities();
		});
		
		$("#submitFilterButton").tap(function(e, info) {
			filterOpenMics();
		});
		
		
		$("#homeBrowseButton").tap(function(e, info){
			$("#home").mask("Loading...");
			loadUnfilteredOpenMics();
		});
		
		
		$("#browseButton").tap(function(e, info){
			$("#homeloggedin").mask("Loading...");
			loadUnfilteredOpenMics();
		});
		
		$("#browse").bind('pageAnimationEnd', function(event, info) {
			if(info.direction == 'in') {
				$("#homeloggedin").unmask();
			}
		});
		
		$("#openmicLink").tap(function(e, info) {
			$(e.target).html("<img src='/images/spinner.gif' width='13px' height='13px' /> " + $(e.target).html());
			loadOpenMicInfo($(e.target).attr("open_mic_id"));
		});
		
		$("#openmicinfo").bind('pageAnimationEnd', function(event, info){
			if(info.direction == 'in')
				$("#browse").unmask();
		});
		
		$("#viewmapLink").tap(function(e, info) {
			loadOpenMicMap($(e.target).attr("gmaps_address"));
		});
		
		
		$("#attendopenmicButton").tap(function(e, info){
			attendOpenMicButtonClick();
		});

		$("#attendeelistButton").tap(function(e, info){
			loadOpenMicAttendeeList();
		});
		
		
		/* Profile */
		$("#profile").bind('pageAnimationStart', function(event, info){
			if(info.direction == 'in')
				loadProfile();
		});
		
		$("#updateprofileButton").tap(function(e, info){
			updateProfile($(e.target).attr("user_id"));
		});
		
		/* Feedback */
		$("#sendFeedbackButton").tap(function(e, info) {
			sendFeedback();
		});
	});

</script>

<%= render 'iphone/sessions' %>
<%= render 'iphone/open_mics' %>
<%= render 'iphone/filter' %>
<%= render 'iphone/profile' %>
<%= render 'iphone/utilities' %>
<%= render 'iphone/feedback' %>


